@model Rahmano_Case.Models.Users

@{
    ViewBag.Title = "Biodata";
}

<h2>Biodata @Session["User_Name"]</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    
    <div class="form-horizontal">
        <div hidden="hidden">
            @Html.EditorFor(model => model.User_Pwd, new { htmlAttributes = new { @class = "form-control" } })
            @Html.EditorFor(model => model.Is_Active, new { htmlAttributes = new { @class = "form-control" } })
        </div>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.User_ID)

        <div class="form-group">
            @Html.LabelFor(model => model.User_Name, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.User_Name, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.User_Name, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.User_Sex, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.User_Sex, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.User_Sex, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.User_BirthDate, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.User_BirthDate, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.User_BirthDate, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">Photo</label>
            <div class="col-md-10">
                <textarea id=@("mon_ket") rows="1" onpaste="pencet()" placeholder="Paste Image Here"></textarea>
                <table border="0">
                    <tr>
                        <td style="width:100px">
                            @if (Model.User_Photo != null)
                            {
                                var imgSrc = $"data:image/jpg;base64,{Convert.ToBase64String(Model.User_Photo)}";
                                <img id=@("User_Photo") src="@imgSrc" alt="Cover Buku" style="width:100px;" />
                            }
                            else
                            {
                                <img id=@("User_Photo") style="display:none;width:100px" alt="Cover Buku" />
                            }
                        </td>
                        <td style="width:10px;"></td>
                        <td style="width:20px;vertical-align:top">
                            @if (Model.User_Photo != null)
                            {
                                <img alt="Delete Image  Cover" id=@("ImageDel") onclick="hapusGambar()" style="height:20px;display:block" src="/images/edit-icon.png" />
                            }
                            else
                            {
                                <img alt="Delete Image Cover" id=@("ImageDel") onclick="hapusGambar()" style="height:20px;display:none" src="/images/edit-icon.png" />
                            }
                        </td>
                        <td></td>
                    </tr>
                </table>
            </div>

        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.User_Login, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.User_Login, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.User_Login, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.User_Email, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.User_Email, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.User_Email, "", new { @class = "text-danger" })
            </div>
        </div>


        <div class="form-group">
            <div class="col-md-offset-2 col-md-1">
                @if (Session["User_Name"] != null)
                {
                    <input type="button" id="cmdSave" value="Save" style="width:90px;" class="btn btn-default" />
                }
                else
                {
                    <input type="button" id="cmdSave" disabled="disabled" value="Save" style="width:90px;" class="btn btn-default" />
                }
            </div>
            <div class="col-md-1">
                <input type="button" id="cmdCancel" value="Cancel" style="width:90px;" class="btn btn-default" />
            </div>
            <div class="col-md-10">
                &nbsp;
            </div>
        </div>
    </div>
}

<div class="form-group">
    <label class="control-label col-md-2">&nbsp;</label>
    <div class="col-md-10">
        @Html.ActionLink("Change Password", "changepass")
    </div>
</div>
@section scripts {
    <script type="text/javascript">
        $('#cmdSave').click(function () {
            alert('Simpan');
        })

        function pencet() {
            nama = "User_Photo";
            tombol = "ImageDel";

            var items = (event.clipboardData || event.originalEvent.clipboardData).items;
            console.log(JSON.stringify(items));

            var blob = null;
            for (var i = 0; i < items.length; i++) {
                if (items[i].type.indexOf("image") === 0) {
                    blob = items[i].getAsFile();
                }
            }

            if (blob !== null) {
                var reader = new FileReader();
                reader.onload = function (event) {
                    console.log(event.target.result); // data url!
                    document.getElementById(nama).src = event.target.result;
                    document.getElementById(nama).style.display = "block";
                    document.getElementById(tombol).style.display = "block";
                    document.getElementById(isiGambar).value = event.target.result;
                };
                reader.readAsDataURL(blob);
            }
        }

        $('#cmdCancel').click(function(){
            window.location.replace("/");
        })

        $('#cmdPwd').click(function () {
            window.location.replace("/users/changepass");
        })
    </script>
}